!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.MessageFactory=t()}}(function(){var t;return function n(t,e,r){function u(o,i){if(!e[o]){if(!t[o]){var c="function"==typeof require&&require;if(!i&&c)return c(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var s=e[o]={exports:{}};t[o][0].call(s.exports,function(n){var e=t[o][1][n];return u(e?e:n)},s,s.exports,n,t,e,r)}return e[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)u(r[o]);return u}({1:[function(t,n,e){"use strict";(function(){var t={pack:function(t,n,e,r,u,a){Array.isArray(e)||(e=[e]);for(var o=0;u>o;o++)n[t](r+o,e[o],a)},unpack:function(t,n,e,r,u){for(var a=[],o=0;r>o;o++)a.push(n[t](e+o,u));return a}},e={A:{length:1,pack:function(n,e,r,u,a){t.pack("setInt8",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getInt8",n,e,r,u)}},x:{length:1,pack:function(t,n,e,r,u){for(var a=0;r>a;a++)t.setUint8(e+a,0)},unpack:function(t,n,e,r){for(var u=[],a=0;e>a;a++)u.push(0);return u}},c:{length:1,pack:function(t,n,e,r,u,a){Array.isArray(e)||(e=[e]);for(var o=0;u>o;o++)n.setUint8(r+o,e[o].charCodeAt(0))},unpack:function(t,n,e,r,u){for(var a=[],o=0;r>o;o++)a.push(String.fromCharCode(n.getUint8(e+o)));return a}},b:{length:1,pack:function(n,e,r,u,a){t.pack("setInt8",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getInt8",n,e,r,u)}},B:{length:1,pack:function(n,e,r,u,a){t.pack("setUint8",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getUint8",n,e,r,u)}},h:{length:2,pack:function(n,e,r,u,a){t.pack("setInt16",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getInt16",n,e,r,u)}},H:{length:2,pack:function(n,e,r,u,a){t.pack("setUint16",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getUint16",n,e,r,u)}},i:{length:4,pack:function(n,e,r,u,a){t.pack("setInt32",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getInt32",n,e,r,u)}},I:{length:4,pack:function(n,e,r,u,a){t.pack("setUint32",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getUint32",n,e,r,u)}},l:{length:4,pack:function(n,e,r,u,a){t.pack("setInt32",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getInt32",n,e,r,u)}},L:{length:4,pack:function(n,e,r,u,a){t.pack("setUint32",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getUint32",n,e,r,u)}},s:{length:1,pack:function(t,n,e,r,u){for(var a=new String(n[0]),o=0;r>o;o++){var i=0;o<a.length&&(i=a.charCodeAt(o)),t.setUint8(e+o,i)}},unpack:function(t,n,e,r){for(var u=[],a=0;e>a;a++)u.push(String.fromCharCode(t.getUint8(n+a)));return[u.join("")]}},f:{length:4,pack:function(n,e,r,u,a){t.pack("setFloat32",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getFloat32",n,e,r,u)}},d:{length:8,pack:function(n,e,r,u,a){t.pack("setFloat64",n,e,r,u,a)},unpack:function(n,e,r,u){return t.unpack("getFloat64",n,e,r,u)}}},r="(\\d+)?([AxcbBhHsfdiIlL])",u=function(t){for(var n,u=new RegExp(r,"g"),a=0;n=u.exec(t);)a+=(void 0==n[1]||""==n[1]?1:parseInt(n[1]))*e[n[2]].length;return a},a=function(t,n,a){var o="<"==t.charAt(0);a=a?a:0;for(var i,c,f,s=new ArrayBuffer(u(t)),p=new DataView(s),l=new RegExp(r,"g"),h=0;i=l.exec(t);){if(void 0==e[i[2]])throw new Error("Unknown format type");if(c=void 0==i[1]||""==i[1]?1:parseInt(i[1]),f=e[i[2]].length,a+c*f>s.length)return;var d=n.slice(h,h+1);e[i[2]].pack(p,d,a,c,o),a+=c*f,h+=1}return s},o=function(t,n,u){for(var a,o,i,c="<"==t.charAt(0),u=u?u:0,f=[],s=new RegExp(r,"g"),p=new DataView(n);a=s.exec(t);){if(void 0==e[a[2]])throw new Error("Unknown format type");if(o=void 0==a[1]||""==a[1]?1:parseInt(a[1]),i=e[a[2]].length,u+o*i>n.length)return;f=f.concat(e[a[2]].unpack(p,u,o,c)),u+=o*i}return f},i={pack:a,unpack:o,calcLength:u,Pack:a,Unpack:o,CalcLength:u};"undefined"!=typeof n&&n.exports?n.exports=i:this.struct=i}).call(void 0)},{}],2:[function(n,e,r){(function(n){"use strict";!function(u){function a(t){for(var n,e,r=[],u=0,a=t.length;a>u;)n=t.charCodeAt(u++),n>=55296&&56319>=n&&a>u?(e=t.charCodeAt(u++),56320==(64512&e)?r.push(((1023&n)<<10)+(1023&e)+65536):(r.push(n),u--)):r.push(n);return r}function o(t){for(var n,e=t.length,r=-1,u="";++r<e;)n=t[r],n>65535&&(n-=65536,u+=b(n>>>10&1023|55296),n=56320|1023&n),u+=b(n);return u}function i(t,n){return b(t>>n&63|128)}function c(t){if(0==(4294967168&t))return b(t);var n="";return 0==(4294965248&t)?n=b(t>>6&31|192):0==(4294901760&t)?(n=b(t>>12&15|224),n+=i(t,6)):0==(4292870144&t)&&(n=b(t>>18&7|240),n+=i(t,12),n+=i(t,6)),n+=b(63&t|128)}function f(t){for(var n,e=a(t),r=e.length,u=-1,o="";++u<r;)n=e[u],o+=c(n);return o}function s(){if(y>=v)throw Error("Invalid byte index");var t=255&k[y];if(y++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function p(){var t,n,e,r,u;if(y>v)throw Error("Invalid byte index");if(y==v)return!1;if(t=255&k[y],y++,0==(128&t))return t;if(192==(224&t)){var n=s();if(u=(31&t)<<6|n,u>=128)return u;throw Error("Invalid continuation byte")}if(224==(240&t)){if(n=s(),e=s(),u=(15&t)<<12|n<<6|e,u>=2048)return u;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=s(),e=s(),r=s(),u=(15&t)<<18|n<<12|e<<6|r,u>=65536&&1114111>=u))return u;throw Error("Invalid UTF-8 detected")}function l(t){k=a(t),v=k.length,y=0;for(var n,e=[];(n=p())!==!1;)e.push(n);return o(e)}var h="object"==typeof r&&r,d="object"==typeof e&&e&&e.exports==h&&e,g="object"==typeof n&&n;(g.global===g||g.window===g)&&(u=g);var k,v,y,b=String.fromCharCode,m={version:"2.0.0",encode:f,decode:l};if("function"==typeof t&&"object"==typeof t.amd&&t.amd)t(function(){return m});else if(h&&!h.nodeType)if(d)d.exports=m;else{var w={},I=w.hasOwnProperty;for(var U in m)I.call(m,U)&&(h[U]=m[U])}else u.utf8=m}(void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,n,e){"use strict";function r(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n["default"]=t,n}function u(t){return t&&t.__esModule?t:{"default":t}}function a(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=t("./message.js"),c=u(i),f=t("./unpackers.js"),s=r(f),p=(Number.MAX_SAFE_INTEGER>Math.pow(2,64)-1?Number.MAX_SAFE_INTEGER:Math.pow(2,64)-1,{bool:"?","byte":"b",ubyte:"B","char":"c","short":"h",ushort:"H","int":"i",uint:"I",int64:"q",uint64:"Q","float":"f","double":"d",string:"s"}),l={};Object.keys(p).forEach(function(t){l[t]=s["unpack"+t.charAt(0).toUpperCase()+t.slice(1)]}),l["enum"]=s.unpackEnum;var h=function(t){return Math.ceil(Math.log(t,2)/8)},d=function(t){var n=h(t);if(1>=n)return"B";if(2===n)return"H";if(4>=n)return"I";if(8>=n)return"Q";throw"Unable to represent number $number in packed structure"},g=function(t){var n=h(t);if(1>=n)return s.unpackUbyte;if(2===n)return s.unpackUshort;if(4>=n)return s.unpackUint;if(8>=n)return s.unpackUint64;throw"No suitable unpacked could be found that could unpack $number"},k=function(){function t(n){a(this,t);var e=Object.keys(n).sort();this.msgClassesByName={},this.msgClassesById={},this.bytesNeededForId=Math.ceil(Math.log(e.length+1,2)/8),this.idBinaryFormat=d(e.length),this.idUnpacker=g(e.length),e.forEach(function(t,e){var r={},u={},a=Object.keys(n[t].format).sort(),o=[];if(n[t].enums)for(var i in n[t].enums){var f=n[t].enums[i];r[i]={},u[i]={};for(var s in f){var p=f[s];r[i][s]=p,u[i][p]=s}}var h=function(){c["default"].call(this)};a.forEach(function(e){var a=l[n[t].format[e]];o.push("enum"===n[t].format[e]?a.bind(h,u[e],g(Object.keys(r).length)):a.bind(h))});var d={name:{value:t,writable:!1},binaryFormat:{value:this.getBinaryFormat(n[t]),writable:!1},format:{value:n[t].format,writable:!1},schema:{value:n,writable:!1},id:{value:e+1,writable:!1},enums:{value:r,writable:!1},reverseEnums:{value:u,writable:!1},length:{value:a.length,writable:!1},keys:{value:a,writable:!1},unpackers:{value:o,writable:!1}};h.prototype=Object.create(c["default"].prototype,d),Object.defineProperties(h,d),this.msgClassesById[e+1]=h,this.msgClassesByName[t]=h}.bind(this))}return o(t,[{key:"getBinaryFormat",value:function(t){var n=Object.keys(t.format).sort(),e="!";return e+=this.idBinaryFormat,n.forEach(function(n){if("string"===t.format[n])e+="I{}s";else if("enum"===t.format[n])try{e+=d(Object.keys(t.format[n]).length)}catch(r){throw"Enum field can contain the maximum number MAX_SUPPORTED_NUMBER possible values."}else try{e+=p[t.format[n]]}catch(r){throw"Unknown field type msgSchema.format[field]."}}),e}},{key:"getByName",value:function(t){return this.msgClassesByName[t]}},{key:"getById",value:function(t){return this.msgClassesById[t]}},{key:"get",value:function(t){return!isNaN(parseInt(t))&&isFinite(t)?this.getById(t):this.getByName(t)}},{key:"unpackMessageInDV",value:function(t,n,e){var r=[],u=[],a=void 0,o=void 0;n=this.idUnpacker(t,n,u),a=this.getById(u.pop()),o=new a;for(var i=0;i<a.length;i++)n=a.unpackers[i](t,n,r),o.data[a.keys[i]]=r[i];return e.push(o),n}},{key:"unpackMessage",value:function(t){var n=[],e=new DataView(t);return this.unpackMessageInDV(e,0,n),n.pop()}},{key:"unpackMessages",value:function(t){for(var n=[],e=new DataView(t),r=0;r<t.byteLength;)r=this.unpackMessageInDV(e,r,n);return n}},{key:"packMessages",value:function(t){for(var n=[],e=t.length,r=0,u=0,a=0;e>a;a++){var o=t[a].pack();n.push(o),r+=o.byteLength}for(var i=new Uint8Array(r),a=0;e>a;a++)i.set(new Uint8Array(n[a]),u),u+=n[a].byteLength;return i.buffer}}]),t}();e["default"]=k,n.exports=e["default"]},{"./message.js":4,"./unpackers.js":6}],4:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function u(){this.data={}}Object.defineProperty(e,"__esModule",{value:!0});var a=t("../bower_components/jspack-arraybuffer/struct.js"),o=r(a),i=t("../bower_components/utf8/utf8.js"),c=r(i),f=t("./string-format.js"),s=r(f);u.prototype.pack=function(){for(var t=Object.getPrototypeOf(this),n=t.format,e=t.binaryFormat,r=t.keys,u=[],a=[t.id],i=0;i<r.length;i++){var f=r[i],p=n[f],l=this.data[f];"enum"===p?l=t.enums[f][l]:"string"===p&&(l=c["default"].encode(l),a.push(l.length),u.push(l.length)),a.push(l)}return e=s["default"](e,u),o["default"].pack(e,a)},u.prototype.getBinaryLength=function(){for(var t=Object.getPrototypeOf(this),n=t.format,e=Object.keys(n).sort(),r=t.binaryFormat,u=[],a=0;a<e.length;a++){var i=e[a];"string"===n[i]&&u.push(this.data[i].length)}return r=s["default"](r,u),o["default"].calcLength(r)},e["default"]=u,n.exports=e["default"]},{"../bower_components/jspack-arraybuffer/struct.js":1,"../bower_components/utf8/utf8.js":2,"./string-format.js":5}],5:[function(t,n,e){"use strict";function r(t,n){var e=0;return t.replace(/\{\}/g,function(){return n[e]})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r,n.exports=e["default"]},{}],6:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function u(t,n,e){return e.push(1===t.getUInt8(n)),n+1}function a(t,n,e){return e.push(t.getInt8(n)),n+1}function o(t,n,e){return e.push(t.getUint8(n)),n+1}function i(t,n,e){return e.push(t.getInt16(n)),n+2}function c(t,n,e){return e.push(t.getUint16(n)),n+2}function f(t,n,e){return e.push(t.getInt32(n)),n+4}function s(t,n,e){return e.push(t.getUint32(n)),n+4}function p(t,n,e){return e.push(t.getInt64(n)),n+8}function l(t,n,e){return e.push(t.getUint64(n)),n+8}function h(t,n,e){return e.push(t.getFloat32(n)),n+4}function d(t,n,e){return e.push(t.getFloat64(n)),n+8}function g(t,n,e){var r,u=t.getUint32(n),a=[];for(n+=4,r=0;u>r;r++)a.push(t.getUint8(n+r));return e.push(y["default"].decode(String.fromCharCode.apply(null,a))),n+u}function k(t,n,e,r,u){var a=[];return r=n(e,r,a),u.push(t[a.pop()]),r}Object.defineProperty(e,"__esModule",{value:!0}),e.unpackBool=u,e.unpackByte=a,e.unpackUbyte=o,e.unpackShort=i,e.unpackUshort=c,e.unpackInt=f,e.unpackUint=s,e.unpackInt64=p,e.unpackUint64=l,e.unpackFloat=h,e.unpackDouble=d,e.unpackString=g,e.unpackEnum=k;var v=t("../bower_components/utf8/utf8.js"),y=r(v)},{"../bower_components/utf8/utf8.js":2}],7:[function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var u=t("./js/message-factory.js"),a=r(u);n.exports=a["default"]},{"./js/message-factory.js":3}]},{},[7])(7)});